{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stop Market - Inicio</title>
  <link rel="stylesheet" href="{% static 'css/inicio.css' %}">
  <link rel="icon" href="{% static 'images/logo.png' %}" type="image/x-icon">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="logo">
        <img src="{% static 'images/logo.png' %}" alt="Logo Stop Market" class="logo">
        <h2>STOP<br>MARKET</h2>
      </div>
      <nav class="nav">
        <a href="#" class="nav-link active"><span>ğŸ </span> Inicio</a>
        <a href="{% url 'inventario' %}" class="nav-link"><span>ğŸ“¦</span> Inventario</a>
        <a href="{% url 'proveedores' %}" class="nav-link"><span>ğŸšš</span> Proveedores</a>
        <a href="{% url 'transacciones' %}" class="nav-link"><span>ğŸ“ˆ</span> Historial de transacciones</a>
      </nav>
      <a href="{% url 'login' %}" class="logout"><span>ğŸ”’</span> Cerrar sesiÃ³n</a>
    </aside>

    <main class="main-content">
      <header class="header">
        <div class="notification">ğŸ””</div>
      </header>

      <section class="dashboard">
        <div class="card">
          <h2><span>ğŸ’µ</span> Efectivo</h2>
          

          <h3>Total: ${{ total_efectivo }}</h3>
        </div>
        <div class="card">
          <h2><span>ğŸ’³</span> Virtual</h2>
          <h3 style="font-size:2rem;">Total: ${{ total_virtual }}</h3>
        </div>
        <div class="card">
          <h2><span>ğŸ“‰</span> Gastos</h2>
          <p>Total gasto: ${{ suma_gastos }}</p>
          <a href="{% url 'agregar_gasto' %}" class="btn btn-primary btn-sm mb-2">Agregar gasto</a>
          <ul class="list-group list-group-flush">
            {% for gasto in gastos %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <strong>{{ gasto.fecha|date:"d/m/Y H:i" }}</strong> - ${{ gasto.monto }}
                  {% if gasto.descripcion %}
                    <span class="text-muted">({{ gasto.descripcion }})</span>
                  {% endif %}
                </div>
              </li>
            {% empty %}
              <li class="list-group-item">No hay gastos aÃºn.</li>
            {% endfor %}
          </ul>
        </div>
        <!--
          <div class="cierre-dia">
             
            <h3>Caja del dÃ­a</h3>
            <form method="post" action="{% url 'cerrar_dia' %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">
                    Cerrar dÃ­a
                </button>
            </form>
        </div>
        -->
      </section>

      <section class="bottom-section">
        <div class="bottom-box">
  <h5 style="padding: 15px 20px 0; color:#132144;">ğŸ’µ Movimientos en efectivo</h5>

<!-- Formulario para agregar ingreso -->
<form method="POST" action="{% url 'agregar_efectivo' %}" class="row g-2 align-items-center px-3 py-2">
  {% csrf_token %}
  <div class="col-auto">
    <input type="number" name="monto" class="form-control form-control-sm" placeholder="Ingrese monto" required>
  </div>
  <div class="col-auto">
    <input type="text" name="descripcion" class="form-control form-control-sm" placeholder="DescripciÃ³n" required>
  </div>
  <div class="col-auto">
    <button type="submit" class="btn btn-primary btn-sm">Agregar</button>
  </div>
</form>

<!-- Lista de movimientos -->
<h6 class="mt-3 px-3">Lista de ingresos</h6>
<ul class="list-group list-group-flush">
  {% for ingreso in ingresos %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <div>
        <strong>{{ ingreso.fecha|date:"d/m/Y H:i" }}</strong> - ${{ ingreso.monto }}
        {% if ingreso.descripcion %}
          <span class="text-muted">({{ ingreso.descripcion }})</span>
        {% endif %}
      </div>
      <div>
        <a href="{% url 'editar_ingreso' ingreso.id %}" class="btn btn-warning btn-sm me-1">âœï¸</a>
        <a href="{% url 'eliminar_ingreso' ingreso.id %}" 
           class="btn btn-danger btn-sm"
           onclick="return confirm('Â¿Seguro que deseas eliminar este ingreso?')">ğŸ—‘ï¸</a>
      </div>
    </li>
  {% empty %}
    <li class="list-group-item">No hay ingresos aÃºn.</li>
  {% endfor %}
</ul>
  </div>
        <div class="bottom-box">
          <h5 style="padding: 15px 20px 0; color:#132144;">ğŸ’³ Movimientos virtuales</h5>

        <!-- Formulario para agregar movimiento virtual -->
        <form method="POST" action="{% url 'agregar_virtual' %}" class="row g-2 align-items-center px-3 py-2">
          {% csrf_token %}
          <div class="col-auto">
            <input type="number" name="monto" class="form-control form-control-sm" placeholder="Ingrese monto" required>
          </div>
          <div class="col-auto">
            <input type="text" name="descripcion" class="form-control form-control-sm" placeholder="DescripciÃ³n" required>
          </div>
          <div class="col-auto">
            <button type="submit" class="btn btn-primary btn-sm">Agregar</button>
          </div>
        </form>

        <!-- Lista de movimientos virtuales -->
        <h6 class="mt-3 px-3">Lista de ingresos</h6>
        <ul class="list-group list-group-flush">
          {% for ingreso in ingresos_virtuales %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <strong>{{ ingreso.fecha|date:"d/m/Y H:i" }}</strong> - ${{ ingreso.monto }}
                {% if ingreso.descripcion %}
                  <span class="text-muted">({{ ingreso.descripcion }})</span>
                {% endif %}
              </div>
              <div>
                <a href="{% url 'editar_virtual' ingreso.id %}" class="btn btn-warning btn-sm me-1">âœï¸</a>
                <a href="{% url 'eliminar_virtual' ingreso.id %}" class="btn btn-danger btn-sm" onclick="return confirm('Â¿Seguro que deseas eliminar este movimiento virtual?')">ğŸ—‘ï¸</a>
              </div>
            </li>
          {% empty %}
            <li class="list-group-item">No hay ingresos virtuales aÃºn.</li>
          {% endfor %}
        </ul>
        </div>
      </section>
    </main>
  </div>
  <script src="inicio.js"></script>
</body>
</html>